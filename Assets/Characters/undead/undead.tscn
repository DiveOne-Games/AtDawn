[gd_scene load_steps=28 format=3 uid="uid://bt5rpt2qc4lbg"]

[ext_resource type="Script" uid="uid://tbs23lxrp7jb" path="res://Assets/Characters/player2d.gd" id="1_3wt10"]
[ext_resource type="Texture2D" uid="uid://bo5b8oeaf561n" path="res://Assets/Characters/Zombie/undead_sprites_all.png" id="2_3wt10"]
[ext_resource type="Script" uid="uid://d0eke6awpxrng" path="res://Assets/Scripts/behavior/behavior_machine.gd" id="3_3wt10"]
[ext_resource type="Script" uid="uid://psdyf3ckvdta" path="res://Assets/Scripts/behavior/character_ctrl.gd" id="3_7cv5a"]
[ext_resource type="Script" uid="uid://bnqmcdui30ia6" path="res://Assets/Scripts/Characters/face.gd" id="3_grklj"]
[ext_resource type="Script" uid="uid://d0mjoprxtttsn" path="res://Assets/Scripts/behavior/patrol.gd" id="4_l1spx"]
[ext_resource type="Resource" uid="uid://b8w8gfudxatnf" path="res://Assets/Resources/Items/weapons/punch.tres" id="5_jevvi"]
[ext_resource type="Animation" uid="uid://d2boox1aa8pri" path="res://Assets/Resources/animations/anim_undead_RESET.res" id="5_wlej6"]
[ext_resource type="Animation" uid="uid://cdg6gs6qt3val" path="res://Assets/Resources/animations/anim_undead_walk.res" id="6_7cv5a"]
[ext_resource type="PackedScene" uid="uid://cf2ta7mrj3mae" path="res://Assets/Prefabs/weapon_2d.tscn" id="6_mlify"]
[ext_resource type="Script" uid="uid://ryg4ifudumer" path="res://Assets/Scripts/velocity.gd" id="6_w4kb6"]
[ext_resource type="Script" uid="uid://dd06154u11qg5" path="res://Assets/Scripts/behavior/idle.gd" id="10_2ka5t"]
[ext_resource type="Script" uid="uid://5qutdxbt7pfk" path="res://Assets/Scripts/behavior/chase.gd" id="10_iuu1t"]
[ext_resource type="PackedScene" uid="uid://5tk7ooyurrrr" path="res://Assets/Characters/shared/react_zone.tscn" id="12_5da4c"]
[ext_resource type="Script" uid="uid://fqrjgxorcsk1" path="res://Assets/Scripts/behavior/attack.gd" id="12_ducu6"]
[ext_resource type="Script" uid="uid://va8iotd07541" path="res://Assets/Scripts/behavior/death.gd" id="16_6ixtw"]
[ext_resource type="Script" uid="uid://dpcd62xplvmdc" path="res://Assets/Scripts/behavior/hurt.gd" id="16_614bx"]
[ext_resource type="Script" uid="uid://ciutknmu4ljw1" path="res://Assets/Characters/hit_box.gd" id="17_614bx"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_sxu3u"]
size = Vector2(20, 14)

[sub_resource type="AnimationLibrary" id="AnimationLibrary_3wt10"]
_data = {
&"RESET": ExtResource("5_wlej6")
}

[sub_resource type="Animation" id="Animation_ducu6"]
resource_name = "attack"
length = 0.8
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.033333335, 0.06666667, 0.10000001, 0.13333334, 0.2, 0.26666668, 0.33333334, 0.4, 0.46666667, 0.53333336, 0.6, 0.6666667, 0.73333335),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 0), Vector2i(1, 0), Vector2i(2, 0), Vector2i(3, 0), Vector2i(4, 0), Vector2i(5, 0), Vector2i(6, 0), Vector2i(7, 0), Vector2i(8, 0), Vector2i(9, 0), Vector2i(10, 0), Vector2i(11, 0), Vector2i(12, 0), Vector2i(13, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Equipment/Weapon2D:disable_shape")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.0019399691, 0.28049198, 0.5),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [true, true, false, true]
}

[sub_resource type="Animation" id="Animation_l1spx"]
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 3), Vector2i(1, 3), Vector2i(2, 3), Vector2i(3, 3), Vector2i(4, 3), Vector2i(5, 3), Vector2i(6, 3), Vector2i(7, 3)]
}

[sub_resource type="Animation" id="Animation_614bx"]
resource_name = "hurt"
length = 0.8
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.06666667, 0.13333334, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 2), Vector2i(1, 2), Vector2i(2, 2), Vector2i(3, 2), Vector2i(4, 2), Vector2i(5, 2), Vector2i(6, 2), Vector2i(7, 2), Vector2i(8, 2)]
}

[sub_resource type="Animation" id="Animation_6ixtw"]
resource_name = "dead"
length = 0.8
step = 0.033
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.06666667, 0.13333334, 0.2, 0.26666668, 0.33333334, 0.4, 0.46666667, 0.5333333, 0.6, 0.6666666, 0.73333335),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 1), Vector2i(1, 1), Vector2i(2, 1), Vector2i(3, 1), Vector2i(4, 1), Vector2i(5, 1), Vector2i(6, 1), Vector2i(7, 1), Vector2i(8, 1), Vector2i(9, 1), Vector2i(10, 1), Vector2i(11, 1)]
}

[sub_resource type="Animation" id="Animation_e0lwe"]
resource_name = "idle2"
length = 0.8
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 4), Vector2i(1, 4), Vector2i(2, 4), Vector2i(3, 4), Vector2i(4, 4), Vector2i(5, 4), Vector2i(6, 4), Vector2i(7, 4)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_grklj"]
_data = {
&"attack": SubResource("Animation_ducu6"),
&"dead": SubResource("Animation_6ixtw"),
&"hurt": SubResource("Animation_614bx"),
&"idle": SubResource("Animation_l1spx"),
&"idle2": SubResource("Animation_e0lwe"),
&"walk": ExtResource("6_7cv5a")
}

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_614bx"]
height = 44.0

[node name="MeleeUnit" type="CharacterBody2D" groups=["enemies", "undead"]]
collision_mask = 18
script = ExtResource("1_3wt10")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(-1, 18)
shape = SubResource("RectangleShape2D_sxu3u")

[node name="Velocity" type="Node" parent="." node_paths=PackedStringArray("character")]
script = ExtResource("6_w4kb6")
character = NodePath("..")

[node name="MotionController" type="Node" parent="." node_paths=PackedStringArray("character")]
script = ExtResource("3_7cv5a")
character = NodePath("..")

[node name="Equipment" type="Node2D" parent="."]
unique_name_in_owner = true

[node name="Weapon2D" parent="Equipment" instance=ExtResource("6_mlify")]
position = Vector2(-5, -3)
collision_layer = 33
collision_mask = 2
item = ExtResource("5_jevvi")

[node name="ReactZone" parent="." node_paths=PackedStringArray("character") instance=ExtResource("12_5da4c")]
character = NodePath("..")

[node name="Sprite2D" type="Sprite2D" parent="."]
unique_name_in_owner = true
texture = ExtResource("2_3wt10")
hframes = 18
vframes = 6
script = ExtResource("3_grklj")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
unique_name_in_owner = true
libraries = {
&"": SubResource("AnimationLibrary_3wt10"),
&"undead": SubResource("AnimationLibrary_grklj")
}

[node name="BehaviorMachine" type="Node" parent="." node_paths=PackedStringArray("initial_state", "hurt", "death")]
unique_name_in_owner = true
script = ExtResource("3_3wt10")
initial_state = NodePath("Idle")
hurt = NodePath("Hurt")
death = NodePath("Death")

[node name="Patrol" type="Node" parent="BehaviorMachine" node_paths=PackedStringArray("chase", "idle")]
script = ExtResource("4_l1spx")
max_duration = 3.0
chase = NodePath("../Chase")
idle = NodePath("../Idle")
behavior_name = "Patrol"
animation = "undead/walk"

[node name="Chase" type="Node" parent="BehaviorMachine" node_paths=PackedStringArray("idle")]
script = ExtResource("10_iuu1t")
idle = NodePath("../Idle")
behavior_name = "Chase"
animation = "undead/walk"

[node name="Idle" type="Node" parent="BehaviorMachine" node_paths=PackedStringArray("attack", "patrol")]
script = ExtResource("10_2ka5t")
is_patrol = true
attack = NodePath("../Attack")
patrol = NodePath("../Patrol")
behavior_name = "Idle"
animation = "undead/idle"

[node name="Hurt" type="Node" parent="BehaviorMachine" node_paths=PackedStringArray("idle", "death")]
script = ExtResource("16_614bx")
idle = NodePath("../Idle")
death = NodePath("../Death")
behavior_name = "Hurt"
animation = "undead/hurt"
resume = true

[node name="Death" type="Node" parent="BehaviorMachine"]
script = ExtResource("16_6ixtw")
behavior_name = "Death"
animation = "undead/death"

[node name="Attack" type="Node" parent="BehaviorMachine" node_paths=PackedStringArray("idle", "hurt", "death")]
script = ExtResource("12_ducu6")
idle = NodePath("../Idle")
hurt = NodePath("../Hurt")
death = NodePath("../Death")
behavior_name = "Attack"
animation = "undead/attack"
resume = true

[node name="AudioStreamPlayer2D" type="AudioStreamPlayer2D" parent="."]

[node name="HitBox" type="Area2D" parent="." node_paths=PackedStringArray("character")]
collision_layer = 33
collision_mask = 2
script = ExtResource("17_614bx")
character = NodePath("..")

[node name="CollisionShape2D" type="CollisionShape2D" parent="HitBox"]
shape = SubResource("CapsuleShape2D_614bx")

[connection signal="velocity_changed" from="Velocity" to="Sprite2D" method="_on_velocity_changed"]
[connection signal="target_updated" from="ReactZone" to="." method="_on_react_zone_target_updated"]
[connection signal="area_shape_entered" from="HitBox" to="HitBox" method="_on_area_shape_entered"]

[editable path="ReactZone"]
