[gd_scene load_steps=41 format=3 uid="uid://p5r27gn3d6hn"]

[ext_resource type="Script" uid="uid://tbs23lxrp7jb" path="res://Assets/Characters/player2d.gd" id="1_tot4p"]
[ext_resource type="Script" uid="uid://ryg4ifudumer" path="res://Assets/Scripts/velocity.gd" id="2_q4ouk"]
[ext_resource type="Resource" uid="uid://002d7glbis54" path="res://Assets/Resources/characters/skeleton.tres" id="2_tot4p"]
[ext_resource type="Texture2D" uid="uid://cuxsy4u6o4f53" path="res://Assets/Characters/Skeleton/Sprites/skeleton1_all.png" id="3_1o2mj"]
[ext_resource type="PackedScene" uid="uid://cf2ta7mrj3mae" path="res://Assets/Prefabs/weapon_2d.tscn" id="4_n56hv"]
[ext_resource type="Resource" uid="uid://b8w8gfudxatnf" path="res://Assets/Resources/Items/weapons/punch.tres" id="5_sugn3"]
[ext_resource type="AudioStream" uid="uid://iewyqhs71o6u" path="res://Assets/StaticAssets/SFX/attack_swing2.wav" id="5_ym7bb"]
[ext_resource type="PackedScene" uid="uid://5tk7ooyurrrr" path="res://Assets/Characters/shared/react_zone.tscn" id="6_dryux"]
[ext_resource type="AudioStream" uid="uid://dkey2qtevfhaf" path="res://Assets/StaticAssets/SFX/being_hurt2.mp3" id="6_sgqua"]
[ext_resource type="Script" uid="uid://bnqmcdui30ia6" path="res://Assets/Scripts/Characters/face.gd" id="8_bv6l6"]
[ext_resource type="Animation" uid="uid://d2boox1aa8pri" path="res://Assets/Resources/animations/anim_undead_RESET.res" id="9_cc1md"]
[ext_resource type="Animation" uid="uid://cdg6gs6qt3val" path="res://Assets/Resources/animations/anim_undead_walk.res" id="10_0pse6"]
[ext_resource type="Script" uid="uid://ciutknmu4ljw1" path="res://Assets/Characters/hit_box.gd" id="11_5qrjo"]
[ext_resource type="PackedScene" uid="uid://beeoekig70q4o" path="res://Assets/Prefabs/behavior/behavior_machine.tscn" id="12_n850w"]
[ext_resource type="PackedScene" uid="uid://c361obudontxu" path="res://Assets/Prefabs/behavior/chase.tscn" id="13_tm1n0"]
[ext_resource type="PackedScene" uid="uid://cay4ak2gn22pu" path="res://Assets/Prefabs/behavior/attack.tscn" id="14_3e7gx"]
[ext_resource type="Shader" uid="uid://dqd4f8f3eb0e7" path="res://Assets/Resources/Shaders/fade.gdshader" id="15_n56hv"]
[ext_resource type="PackedScene" uid="uid://ckbbg7l31od8a" path="res://Assets/Prefabs/behavior/idle.tscn" id="15_ncngo"]
[ext_resource type="PackedScene" uid="uid://dk4wlgy0qgxsy" path="res://Assets/Prefabs/behavior/hurt.tscn" id="16_f166n"]
[ext_resource type="PackedScene" uid="uid://ctnihc2a51ncc" path="res://Assets/Prefabs/behavior/patrol.tscn" id="17_q2mgd"]
[ext_resource type="PackedScene" uid="uid://dlf6faof3gai6" path="res://Assets/Prefabs/behavior/death.tscn" id="18_18anc"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_sxu3u"]
size = Vector2(20, 14)

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_614bx"]
height = 44.0

[sub_resource type="ShaderMaterial" id="ShaderMaterial_sugn3"]
shader = ExtResource("15_n56hv")
shader_parameter/fade = 1.0
shader_parameter/offset = 0.0

[sub_resource type="AnimationLibrary" id="AnimationLibrary_3wt10"]
_data = {
&"RESET": ExtResource("9_cc1md")
}

[sub_resource type="Animation" id="Animation_xyvrx"]
length = 0.9
step = 0.05
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 2), Vector2i(1, 2), Vector2i(2, 2), Vector2i(3, 2), Vector2i(4, 2), Vector2i(5, 2), Vector2i(6, 2), Vector2i(7, 2), Vector2i(8, 2), Vector2i(9, 2), Vector2i(10, 2), Vector2i(11, 2), Vector2i(12, 2), Vector2i(13, 2), Vector2i(14, 2), Vector2i(15, 2), Vector2i(16, 2)]
}
tracks/1/type = "audio"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("AudioStreamPlayer2D")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"clips": [{
"end_offset": 0.179427,
"start_offset": 0.0343583,
"stream": ExtResource("5_ym7bb")
}],
"times": PackedFloat32Array(0.55)
}
tracks/1/use_blend = true

[sub_resource type="Animation" id="Animation_t7qxx"]
length = 1.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 4), Vector2i(1, 4), Vector2i(2, 4), Vector2i(3, 4), Vector2i(4, 4), Vector2i(5, 4), Vector2i(6, 4), Vector2i(7, 4), Vector2i(8, 4), Vector2i(9, 4), Vector2i(10, 4), Vector2i(11, 4)]
}
tracks/1/type = "audio"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("AudioStreamPlayer2D")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"clips": [{
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource("6_sgqua")
}],
"times": PackedFloat32Array(0)
}
tracks/1/use_blend = true

[sub_resource type="Animation" id="Animation_wnco7"]
length = 1.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 3), Vector2i(1, 3), Vector2i(2, 3), Vector2i(3, 3), Vector2i(4, 3), Vector2i(5, 3), Vector2i(6, 3), Vector2i(7, 3), Vector2i(8, 3), Vector2i(9, 3), Vector2i(10, 3)]
}
tracks/1/type = "audio"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("AudioStreamPlayer2D")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"clips": [{
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource("6_sgqua")
}],
"times": PackedFloat32Array(0)
}
tracks/1/use_blend = true

[sub_resource type="Animation" id="Animation_ve13l"]
resource_name = "idle"
length = 0.7
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 0), Vector2i(1, 0), Vector2i(2, 0), Vector2i(3, 0), Vector2i(4, 0), Vector2i(5, 0), Vector2i(6, 0)]
}

[sub_resource type="Animation" id="Animation_5nbcy"]
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 2), Vector2i(1, 2), Vector2i(2, 2), Vector2i(3, 2), Vector2i(4, 2), Vector2i(5, 2), Vector2i(6, 2), Vector2i(7, 2)]
}

[sub_resource type="Animation" id="Animation_70nbn"]
length = 0.5
loop_mode = 1
step = 0.05
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 1), Vector2i(1, 1), Vector2i(2, 1), Vector2i(3, 1), Vector2i(4, 1), Vector2i(5, 1), Vector2i(6, 1), Vector2i(7, 1)]
}

[sub_resource type="Animation" id="Animation_37ne6"]
resource_name = "spawn"
length = 0.8
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 0), Vector2i(1, 0), Vector2i(2, 0), Vector2i(3, 0), Vector2i(4, 0), Vector2i(5, 0), Vector2i(6, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Sprite2D:material:shader_parameter/offset")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.8),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [1.0, 0.0]
}

[sub_resource type="Animation" id="Animation_2yy3c"]
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.126116, 0.245702, 0.369641, 0.500109, 0.632754, 0.771818, 0.9),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 1), Vector2i(1, 1), Vector2i(2, 1), Vector2i(3, 1), Vector2i(4, 1), Vector2i(5, 1), Vector2i(6, 1), Vector2i(7, 1)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_dryux"]
_data = {
&"attack": SubResource("Animation_xyvrx"),
&"death": SubResource("Animation_t7qxx"),
&"hurt": SubResource("Animation_wnco7"),
&"idle": SubResource("Animation_ve13l"),
&"idle2": SubResource("Animation_5nbcy"),
&"run": SubResource("Animation_70nbn"),
&"spawn": SubResource("Animation_37ne6"),
&"walk": SubResource("Animation_2yy3c")
}

[sub_resource type="Animation" id="Animation_ducu6"]
resource_name = "attack"
length = 0.8
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.033333335, 0.06666667, 0.10000001, 0.13333334, 0.2, 0.26666668, 0.33333334, 0.4, 0.46666667, 0.53333336, 0.6, 0.6666667, 0.73333335),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 0), Vector2i(1, 0), Vector2i(2, 0), Vector2i(3, 0), Vector2i(4, 0), Vector2i(5, 0), Vector2i(6, 0), Vector2i(7, 0), Vector2i(8, 0), Vector2i(9, 0), Vector2i(10, 0), Vector2i(11, 0), Vector2i(12, 0), Vector2i(13, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Equipment/Weapon2D:disable_shape")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.0019399691, 0.28049198, 0.5),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [true, true, false, true]
}

[sub_resource type="Animation" id="Animation_6ixtw"]
resource_name = "dead"
length = 0.8
step = 0.033
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.06666667, 0.13333334, 0.2, 0.26666668, 0.33333334, 0.4, 0.46666667, 0.5333333, 0.6, 0.6666666, 0.73333335),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 1), Vector2i(1, 1), Vector2i(2, 1), Vector2i(3, 1), Vector2i(4, 1), Vector2i(5, 1), Vector2i(6, 1), Vector2i(7, 1), Vector2i(8, 1), Vector2i(9, 1), Vector2i(10, 1), Vector2i(11, 1)]
}

[sub_resource type="Animation" id="Animation_614bx"]
resource_name = "hurt"
length = 0.8
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.06666667, 0.13333334, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 2), Vector2i(1, 2), Vector2i(2, 2), Vector2i(3, 2), Vector2i(4, 2), Vector2i(5, 2), Vector2i(6, 2), Vector2i(7, 2), Vector2i(8, 2)]
}

[sub_resource type="Animation" id="Animation_l1spx"]
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 3), Vector2i(1, 3), Vector2i(2, 3), Vector2i(3, 3), Vector2i(4, 3), Vector2i(5, 3), Vector2i(6, 3), Vector2i(7, 3)]
}

[sub_resource type="Animation" id="Animation_e0lwe"]
resource_name = "idle2"
length = 0.8
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 4), Vector2i(1, 4), Vector2i(2, 4), Vector2i(3, 4), Vector2i(4, 4), Vector2i(5, 4), Vector2i(6, 4), Vector2i(7, 4)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_grklj"]
_data = {
&"attack": SubResource("Animation_ducu6"),
&"dead": SubResource("Animation_6ixtw"),
&"hurt": SubResource("Animation_614bx"),
&"idle": SubResource("Animation_l1spx"),
&"idle2": SubResource("Animation_e0lwe"),
&"walk": ExtResource("10_0pse6")
}

[node name="Skeleton" type="CharacterBody2D" groups=["enemies", "undead"]]
collision_mask = 18
script = ExtResource("1_tot4p")
stats = ExtResource("2_tot4p")
health = 12

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(-1, 18)
shape = SubResource("RectangleShape2D_sxu3u")

[node name="Velocity" type="Node" parent="." node_paths=PackedStringArray("character")]
script = ExtResource("2_q4ouk")
character = NodePath("..")

[node name="Equipment" type="Node2D" parent="."]
unique_name_in_owner = true

[node name="Weapon2D" parent="Equipment" instance=ExtResource("4_n56hv")]
position = Vector2(-5, -3)
collision_layer = 32
collision_mask = 2
item = ExtResource("5_sugn3")

[node name="HitBox" type="Area2D" parent="." node_paths=PackedStringArray("character")]
collision_layer = 32
collision_mask = 2
script = ExtResource("11_5qrjo")
character = NodePath("..")

[node name="CollisionShape2D" type="CollisionShape2D" parent="HitBox"]
shape = SubResource("CapsuleShape2D_614bx")

[node name="ReactZone" parent="." node_paths=PackedStringArray("character") instance=ExtResource("6_dryux")]
character = NodePath("..")

[node name="BehaviorMachine" parent="." node_paths=PackedStringArray("initial_state", "hurt", "death") instance=ExtResource("12_n850w")]
initial_state = NodePath("Idle")
hurt = NodePath("Hurt")
death = NodePath("Death")

[node name="Chase" parent="BehaviorMachine" node_paths=PackedStringArray("idle") instance=ExtResource("13_tm1n0")]
idle = NodePath("../Idle")
animation = "skeleton/run"

[node name="Attack" parent="BehaviorMachine" node_paths=PackedStringArray("idle") instance=ExtResource("14_3e7gx")]
idle = NodePath("../Idle")
animation = "skeleton/attack"

[node name="Idle" parent="BehaviorMachine" node_paths=PackedStringArray("attack", "patrol") instance=ExtResource("15_ncngo")]
attack = NodePath("../Attack")
patrol = NodePath("../Patrol")
animation = "skeleton/idle"

[node name="Hurt" parent="BehaviorMachine" node_paths=PackedStringArray("idle", "death", "attack") instance=ExtResource("16_f166n")]
idle = NodePath("../Idle")
death = NodePath("../Death")
attack = NodePath("../Attack")
animation = "skeleton/hurt"

[node name="Patrol" parent="BehaviorMachine" node_paths=PackedStringArray("chase", "idle") instance=ExtResource("17_q2mgd")]
chase = NodePath("../Chase")
idle = NodePath("../Idle")
animation = "skeleton/walk"

[node name="Death" parent="BehaviorMachine" instance=ExtResource("18_18anc")]
animation = "skeleton/death"

[node name="Sprite2D" type="Sprite2D" parent="."]
unique_name_in_owner = true
material = SubResource("ShaderMaterial_sugn3")
texture = ExtResource("3_1o2mj")
hframes = 17
vframes = 5
script = ExtResource("8_bv6l6")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
unique_name_in_owner = true
libraries = {
&"": SubResource("AnimationLibrary_3wt10"),
&"skeleton": SubResource("AnimationLibrary_dryux"),
&"undead": SubResource("AnimationLibrary_grklj")
}

[node name="AudioStreamPlayer2D" type="AudioStreamPlayer2D" parent="."]

[connection signal="velocity_changed" from="Velocity" to="Sprite2D" method="_on_velocity_changed"]
[connection signal="area_shape_entered" from="HitBox" to="HitBox" method="_on_area_shape_entered"]
[connection signal="target_updated" from="ReactZone" to="." method="_on_react_zone_target_updated"]

[editable path="ReactZone"]
